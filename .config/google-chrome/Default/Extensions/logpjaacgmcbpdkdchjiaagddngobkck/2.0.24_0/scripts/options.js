"use strict";var app=angular.module("ShortkeysOptions",["ui.bootstrap","ui.codemirror"]);app.controller("ShortkeysOptionsCtrl",["$scope",function(o){o.editorOptions={lineWrapping:!0,autoCloseBrackets:!0,mode:"javascript"},o.actionOptions=[{value:"top",label:"Scroll to top",group:"Scrolling",builtin:!0},{value:"bottom",label:"Scroll to bottom",group:"Scrolling",builtin:!0},{value:"scrolldown",label:"Scroll down",group:"Scrolling",builtin:!0},{value:"scrolldownmore",label:"Scroll down more",group:"Scrolling",builtin:!0},{value:"scrollup",label:"Scroll up",group:"Scrolling",builtin:!0},{value:"scrollupmore",label:"Scroll up more",group:"Scrolling",builtin:!0},{value:"scrollright",label:"Scroll right",group:"Scrolling",builtin:!0},{value:"scrollrightmore",label:"Scroll right more",group:"Scrolling",builtin:!0},{value:"scrollleft",label:"Scroll left",group:"Scrolling",builtin:!0},{value:"scrollleftmore",label:"Scroll left more",group:"Scrolling",builtin:!0},{value:"back",label:"Go back",group:"Location",builtin:!0},{value:"forward",label:"Go forward",group:"Location",builtin:!0},{value:"reload",label:"Reload page",group:"Location",builtin:!0},{value:"copyurl",label:"Copy URL",group:"Location",builtin:!0},{value:"openbookmark",label:"Open Bookmark/Bookmarklet in current tab",group:"Bookmarks"},{value:"openbookmarknewtab",label:"Open Bookmark/Bookmarklet in new tab",group:"Bookmarks"},{value:"openbookmarkbackgroundtab",label:"Open Bookmark/Bookmarklet in new background tab",group:"Bookmarks"},{value:"gototab",label:"Jump to tab or URL",group:"Tabs"},{value:"newtab",label:"New tab",group:"Tabs",builtin:!0},{value:"closetab",label:"Close tab",group:"Tabs",builtin:!0},{value:"onlytab",label:"Close other tabs",group:"Tabs",builtin:!0},{value:"closelefttabs",label:"Close tabs to the left",group:"Tabs",builtin:!0},{value:"closerighttabs",label:"Close tabs to the right",group:"Tabs",builtin:!0},{value:"clonetab",label:"Duplicate tab",group:"Tabs",builtin:!0},{value:"reopentab",label:"Reopen last closed tab",group:"Tabs",builtin:!0},{value:"nexttab",label:"Next tab",group:"Tabs",builtin:!0},{value:"prevtab",label:"Previous tab",group:"Tabs",builtin:!0},{value:"firsttab",label:"First tab",group:"Tabs",builtin:!0},{value:"lasttab",label:"Last tab",group:"Tabs",builtin:!0},{value:"togglepin",label:"Pin/unpin tab",group:"Tabs",builtin:!0},{value:"movetableft",label:"Move tab left",group:"Tabs",builtin:!0},{value:"movetabright",label:"Move tab right",group:"Tabs",builtin:!0},{value:"newwindow",label:"New window",group:"Windows",builtin:!0},{value:"newprivatewindow",label:"New private window",group:"Windows",builtin:!0},{value:"closewindow",label:"Close window",group:"Windows",builtin:!0},{value:"zoomin",label:"Zoom In",group:"Zooming",builtin:!0},{value:"zoomout",label:"Zoom Out",group:"Zooming",builtin:!0},{value:"zoomreset",label:"Reset Zoom",group:"Zooming",builtin:!0},{value:"javascript",label:"Run JavaScript",group:"Other"},{value:"cleardownloads",label:"Clear downloads",group:"Other",builtin:!0},{value:"disable",label:"Do nothing (disable Chrome shortcut)",group:"Other",builtin:!0},{value:"buttonnexttab",label:"Click button and switch to next tab (for Tribal Wars players)",group:"Other"}],o.isBuiltIn=function(l){for(var e=0,t=o.actionOptions.length;e<t;e++)if(o.actionOptions[e].value===l)return o.actionOptions[e].builtin||!1},o.alerts=[],o.closeAlert=function(l){o.alerts.splice(l,1)};var l=function t(l){for(var e=0;e<l.length;e++)o.bookmarks.push(l[e].title),l[e].children&&t(l[e].children)};o.bookmarks=[],chrome.bookmarks.getTree(function(e){l(e),o.bookmarks.sort(),o.bookmarks=o.bookmarks.filter(function(o){return""!==o})});var e=function(l){if("none"===l)return"New keyboard shortcut";for(var e=0,t=o.actionOptions.length;e<t;e++)if(o.actionOptions[e].value===l)return o.actionOptions[e].label};o.keyLabel=function(o){return o.customName?o.customName:e(o.action)},o.keys=[],o.addBlankIfEmpty=function(){0===o.keys.length&&o.addEmpty()},o.addEmpty=function(){o.keys.push({key:"",action:"none",blacklist:!1,sites:"*mail.google.com*",open:!0})},o.deleteKey=function(l){o.keys.splice(l,1)},o.saveKeys=function(){o.keys=o.keys.filter(function(o){return o&&""!==o.key});for(var l=0;l<o.keys.length;l++)o.keys[l].open=!1,"string"==typeof o.keys[l].sites?o.keys[l].sitesArray=o.keys[l].sites.split("\n"):o.keys[l].sitesArray=o.keys[l].sites;var e={keys:o.keys};chrome.storage.sync.set(e,function(){chrome.runtime.lastError&&chrome.storage.sync.clear(function(){o.alerts=[{type:"success",msg:"Your settings were saved, but they were too large to be synced to any other Chrome installations you have due to Chrome's 8KB limitation on the storage sync API. Everything will still work, but if you are logged into Chrome on any other computers, the settings won't sync there."}],o.$apply()})}),localStorage.shortkeys=JSON.stringify(e),o.alerts=[{type:"success",msg:"Your settings were saved! Reload your tabs to use your new shortcuts."}],o.addBlankIfEmpty(),window.scroll(0,0)},chrome.storage.sync.get(null,function(l){if(l&&l.keys)o.keys=l.keys;else{var e=localStorage.shortkeys;if(e){var t=JSON.parse(e);o.keys=t.keys||[]}}o.addBlankIfEmpty(),o.$apply()})}]);
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNjcmlwdHMvb3B0aW9ucy5qcyJdLCJuYW1lcyI6WyJhcHAiLCJhbmd1bGFyIiwibW9kdWxlIiwiY29udHJvbGxlciIsIiRzY29wZSIsImVkaXRvck9wdGlvbnMiLCJsaW5lV3JhcHBpbmciLCJhdXRvQ2xvc2VCcmFja2V0cyIsIm1vZGUiLCJhY3Rpb25PcHRpb25zIiwidmFsdWUiLCJsYWJlbCIsImdyb3VwIiwiYnVpbHRpbiIsImlzQnVpbHRJbiIsImFjdGlvbiIsImkiLCJsZW4iLCJsZW5ndGgiLCJhbGVydHMiLCJjbG9zZUFsZXJ0IiwiaW5kZXgiLCJzcGxpY2UiLCJ0cmF2ZXJzZUJvb2ttYXJrcyIsImJvb2ttYXJrVHJlZU5vZGVzIiwiYm9va21hcmtzIiwicHVzaCIsInRpdGxlIiwiY2hpbGRyZW4iLCJjaHJvbWUiLCJnZXRUcmVlIiwicmVzdWx0cyIsInNvcnQiLCJmaWx0ZXIiLCJuIiwiYWN0aW9uVG9MYWJlbCIsImtleUxhYmVsIiwia2V5IiwiY3VzdG9tTmFtZSIsImtleXMiLCJhZGRCbGFua0lmRW1wdHkiLCJhZGRFbXB0eSIsImJsYWNrbGlzdCIsInNpdGVzIiwib3BlbiIsImRlbGV0ZUtleSIsInNhdmVLZXlzIiwiZWxlbWVudCIsInNpdGVzQXJyYXkiLCJzcGxpdCIsInNldHRpbmdzIiwic3RvcmFnZSIsInN5bmMiLCJzZXQiLCJydW50aW1lIiwibGFzdEVycm9yIiwiY2xlYXIiLCJ0eXBlIiwibXNnIiwiJGFwcGx5IiwibG9jYWxTdG9yYWdlIiwic2hvcnRrZXlzIiwiSlNPTiIsInN0cmluZ2lmeSIsIndpbmRvdyIsInNjcm9sbCIsImdldCIsInJlc3BvbnNlIiwic2V0dGluZ3NTdHIiLCJwYXJzZSJdLCJtYXBwaW5ncyI6IkFBQUEsWUFHQSxJQUFJQSxLQUFNQyxRQUFRQyxPQUFPLG9CQUFxQixlQUFnQixpQkFFOURGLEtBQUlHLFdBQVcsd0JBQXlCLFNBQVUsU0FBVUMsR0FHeERBLEVBQU9DLGVBQ0hDLGNBQWMsRUFDZEMsbUJBQW1CLEVBQ25CQyxLQUFNLGNBSVZKLEVBQU9LLGdCQUFtQkMsTUFBTyxNQUFPQyxNQUFPLGdCQUFpQkMsTUFBTyxZQUFhQyxTQUFTLElBQVVILE1BQU8sU0FBVUMsTUFBTyxtQkFBb0JDLE1BQU8sWUFBYUMsU0FBUyxJQUFVSCxNQUFPLGFBQWNDLE1BQU8sY0FBZUMsTUFBTyxZQUFhQyxTQUFTLElBQVVILE1BQU8saUJBQWtCQyxNQUFPLG1CQUFvQkMsTUFBTyxZQUFhQyxTQUFTLElBQVVILE1BQU8sV0FBWUMsTUFBTyxZQUFhQyxNQUFPLFlBQWFDLFNBQVMsSUFBVUgsTUFBTyxlQUFnQkMsTUFBTyxpQkFBa0JDLE1BQU8sWUFBYUMsU0FBUyxJQUFVSCxNQUFPLGNBQWVDLE1BQU8sZUFBZ0JDLE1BQU8sWUFBYUMsU0FBUyxJQUFVSCxNQUFPLGtCQUFtQkMsTUFBTyxvQkFBcUJDLE1BQU8sWUFBYUMsU0FBUyxJQUFVSCxNQUFPLGFBQWNDLE1BQU8sY0FBZUMsTUFBTyxZQUFhQyxTQUFTLElBQVVILE1BQU8saUJBQWtCQyxNQUFPLG1CQUFvQkMsTUFBTyxZQUFhQyxTQUFTLElBQVVILE1BQU8sT0FBUUMsTUFBTyxVQUFXQyxNQUFPLFdBQVlDLFNBQVMsSUFBVUgsTUFBTyxVQUFXQyxNQUFPLGFBQWNDLE1BQU8sV0FBWUMsU0FBUyxJQUFVSCxNQUFPLFNBQVVDLE1BQU8sY0FBZUMsTUFBTyxXQUFZQyxTQUFTLElBQVVILE1BQU8sVUFBV0MsTUFBTyxXQUFZQyxNQUFPLFdBQVlDLFNBQVMsSUFBVUgsTUFBTyxlQUFnQkMsTUFBTywyQ0FBNENDLE1BQU8sY0FBaUJGLE1BQU8scUJBQXNCQyxNQUFPLHVDQUF3Q0MsTUFBTyxjQUFpQkYsTUFBTyw0QkFBNkJDLE1BQU8sa0RBQW1EQyxNQUFPLGNBQWlCRixNQUFPLFVBQVdDLE1BQU8scUJBQXNCQyxNQUFPLFNBQVlGLE1BQU8sU0FBVUMsTUFBTyxVQUFXQyxNQUFPLE9BQVFDLFNBQVMsSUFBVUgsTUFBTyxXQUFZQyxNQUFPLFlBQWFDLE1BQU8sT0FBUUMsU0FBUyxJQUFVSCxNQUFPLFVBQVdDLE1BQU8sbUJBQW9CQyxNQUFPLE9BQVFDLFNBQVMsSUFBVUgsTUFBTyxnQkFBaUJDLE1BQU8seUJBQTBCQyxNQUFPLE9BQVFDLFNBQVMsSUFBVUgsTUFBTyxpQkFBa0JDLE1BQU8sMEJBQTJCQyxNQUFPLE9BQVFDLFNBQVMsSUFBVUgsTUFBTyxXQUFZQyxNQUFPLGdCQUFpQkMsTUFBTyxPQUFRQyxTQUFTLElBQVVILE1BQU8sWUFBYUMsTUFBTyx5QkFBMEJDLE1BQU8sT0FBUUMsU0FBUyxJQUFVSCxNQUFPLFVBQVdDLE1BQU8sV0FBWUMsTUFBTyxPQUFRQyxTQUFTLElBQVVILE1BQU8sVUFBV0MsTUFBTyxlQUFnQkMsTUFBTyxPQUFRQyxTQUFTLElBQVVILE1BQU8sV0FBWUMsTUFBTyxZQUFhQyxNQUFPLE9BQVFDLFNBQVMsSUFBVUgsTUFBTyxVQUFXQyxNQUFPLFdBQVlDLE1BQU8sT0FBUUMsU0FBUyxJQUFVSCxNQUFPLFlBQWFDLE1BQU8sZ0JBQWlCQyxNQUFPLE9BQVFDLFNBQVMsSUFBVUgsTUFBTyxjQUFlQyxNQUFPLGdCQUFpQkMsTUFBTyxPQUFRQyxTQUFTLElBQVVILE1BQU8sZUFBZ0JDLE1BQU8saUJBQWtCQyxNQUFPLE9BQVFDLFNBQVMsSUFBVUgsTUFBTyxZQUFhQyxNQUFPLGFBQWNDLE1BQU8sVUFBV0MsU0FBUyxJQUFVSCxNQUFPLG1CQUFvQkMsTUFBTyxxQkFBc0JDLE1BQU8sVUFBV0MsU0FBUyxJQUFVSCxNQUFPLGNBQWVDLE1BQU8sZUFBZ0JDLE1BQU8sVUFBV0MsU0FBUyxJQUFVSCxNQUFPLFNBQVVDLE1BQU8sVUFBV0MsTUFBTyxVQUFXQyxTQUFTLElBQVVILE1BQU8sVUFBV0MsTUFBTyxXQUFZQyxNQUFPLFVBQVdDLFNBQVMsSUFBVUgsTUFBTyxZQUFhQyxNQUFPLGFBQWNDLE1BQU8sVUFBV0MsU0FBUyxJQUFVSCxNQUFPLGFBQWNDLE1BQU8saUJBQWtCQyxNQUFPLFVBQWFGLE1BQU8saUJBQWtCQyxNQUFPLGtCQUFtQkMsTUFBTyxRQUFTQyxTQUFTLElBQVVILE1BQU8sVUFBV0MsTUFBTyx1Q0FBd0NDLE1BQU8sUUFBU0MsU0FBUyxJQUFVSCxNQUFPLGdCQUFpQkMsTUFBTyxnRUFBaUVDLE1BQU8sVUFFLzVHUixFQUFPVSxVQUFZLFNBQVVDLEdBQ3pCLElBQUssR0FBSUMsR0FBSSxFQUFHQyxFQUFNYixFQUFPSyxjQUFjUyxPQUFRRixFQUFJQyxFQUFLRCxJQUN4RCxHQUFJWixFQUFPSyxjQUFjTyxHQUFHTixRQUFVSyxFQUNsQyxNQUFPWCxHQUFPSyxjQUFjTyxHQUFHSCxVQUFXLEdBTXREVCxFQUFPZSxVQU9QZixFQUFPZ0IsV0FBYSxTQUFVQyxHQUMxQmpCLEVBQU9lLE9BQU9HLE9BQU9ELEVBQU8sR0FRaEMsSUFBSUUsR0FBb0IsUUFBU0EsR0FBa0JDLEdBQy9DLElBQUssR0FBSVIsR0FBSSxFQUFHQSxFQUFJUSxFQUFrQk4sT0FBUUYsSUFDMUNaLEVBQU9xQixVQUFVQyxLQUFLRixFQUFrQlIsR0FBR1csT0FDdkNILEVBQWtCUixHQUFHWSxVQUNyQkwsRUFBa0JDLEVBQWtCUixHQUFHWSxVQU1uRHhCLEdBQU9xQixhQUNQSSxPQUFPSixVQUFVSyxRQUFRLFNBQVVDLEdBQy9CUixFQUFrQlEsR0FDbEIzQixFQUFPcUIsVUFBVU8sT0FDakI1QixFQUFPcUIsVUFBWXJCLEVBQU9xQixVQUFVUSxPQUFPLFNBQVVDLEdBQ2pELE1BQWEsS0FBTkEsS0FTZixJQUFJQyxHQUFnQixTQUF1QnBCLEdBQ3ZDLEdBQWUsU0FBWEEsRUFDQSxNQUFPLHVCQUVYLEtBQUssR0FBSUMsR0FBSSxFQUFHQyxFQUFNYixFQUFPSyxjQUFjUyxPQUFRRixFQUFJQyxFQUFLRCxJQUN4RCxHQUFJWixFQUFPSyxjQUFjTyxHQUFHTixRQUFVSyxFQUNsQyxNQUFPWCxHQUFPSyxjQUFjTyxHQUFHTCxNQUszQ1AsR0FBT2dDLFNBQVcsU0FBVUMsR0FDeEIsTUFBSUEsR0FBSUMsV0FDR0QsRUFBSUMsV0FFSkgsRUFBY0UsRUFBSXRCLFNBSWpDWCxFQUFPbUMsUUFLUG5DLEVBQU9vQyxnQkFBa0IsV0FDTSxJQUF2QnBDLEVBQU9tQyxLQUFLckIsUUFDWmQsRUFBT3FDLFlBT2ZyQyxFQUFPcUMsU0FBVyxXQUNkckMsRUFBT21DLEtBQUtiLE1BQ1JXLElBQUssR0FDTHRCLE9BQVEsT0FDUjJCLFdBQVcsRUFDWEMsTUFBTyxvQkFDUEMsTUFBTSxLQVNkeEMsRUFBT3lDLFVBQVksU0FBVXhCLEdBQ3pCakIsRUFBT21DLEtBQUtqQixPQUFPRCxFQUFPLElBTTlCakIsRUFBTzBDLFNBQVcsV0FHZDFDLEVBQU9tQyxLQUFPbkMsRUFBT21DLEtBQUtOLE9BQU8sU0FBVWMsR0FDdkMsTUFBT0EsSUFBMkIsS0FBaEJBLEVBQVFWLEtBSTlCLEtBQUssR0FBSXJCLEdBQUksRUFBR0EsRUFBSVosRUFBT21DLEtBQUtyQixPQUFRRixJQUNwQ1osRUFBT21DLEtBQUt2QixHQUFHNEIsTUFBTyxFQUNjLGdCQUF6QnhDLEdBQU9tQyxLQUFLdkIsR0FBRzJCLE1BQ3RCdkMsRUFBT21DLEtBQUt2QixHQUFHZ0MsV0FBYTVDLEVBQU9tQyxLQUFLdkIsR0FBRzJCLE1BQU1NLE1BQU0sTUFFdkQ3QyxFQUFPbUMsS0FBS3ZCLEdBQUdnQyxXQUFhNUMsRUFBT21DLEtBQUt2QixHQUFHMkIsS0FLbkQsSUFBSU8sSUFBYVgsS0FBTW5DLEVBQU9tQyxLQUM5QlYsUUFBT3NCLFFBQVFDLEtBQUtDLElBQUlILEVBQVUsV0FDMUJyQixPQUFPeUIsUUFBUUMsV0FDZjFCLE9BQU9zQixRQUFRQyxLQUFLSSxNQUFNLFdBQ3RCcEQsRUFBT2UsU0FBWXNDLEtBQU0sVUFBV0MsSUFBSywyUkFDekN0RCxFQUFPdUQsYUFJbkJDLGFBQWFDLFVBQVlDLEtBQUtDLFVBQVViLEdBR3hDOUMsRUFBT2UsU0FBWXNDLEtBQU0sVUFBV0MsSUFBSywwRUFDekN0RCxFQUFPb0Msa0JBQ1B3QixPQUFPQyxPQUFPLEVBQUcsSUFLckJwQyxPQUFPc0IsUUFBUUMsS0FBS2MsSUFBSSxLQUFNLFNBQVVDLEdBQ3BDLEdBQUlBLEdBQVlBLEVBQVM1QixLQUNyQm5DLEVBQU9tQyxLQUFPNEIsRUFBUzVCLFNBQ3BCLENBQ0gsR0FBSTZCLEdBQWNSLGFBQWFDLFNBQy9CLElBQUlPLEVBQWEsQ0FDYixHQUFJbEIsR0FBV1ksS0FBS08sTUFBTUQsRUFDMUJoRSxHQUFPbUMsS0FBT1csRUFBU1gsVUFHL0JuQyxFQUFPb0Msa0JBQ1BwQyxFQUFPdUQiLCJmaWxlIjoic2NyaXB0cy9vcHRpb25zLmpzIiwic291cmNlc0NvbnRlbnQiOlsiJ3VzZSBzdHJpY3QnO1xuLyoganNoaW50IHVuZGVmOiBmYWxzZSwgdW51c2VkOiBmYWxzZSAqL1xuXG52YXIgYXBwID0gYW5ndWxhci5tb2R1bGUoJ1Nob3J0a2V5c09wdGlvbnMnLCBbJ3VpLmJvb3RzdHJhcCcsICd1aS5jb2RlbWlycm9yJ10pO1xuXG5hcHAuY29udHJvbGxlcignU2hvcnRrZXlzT3B0aW9uc0N0cmwnLCBbJyRzY29wZScsIGZ1bmN0aW9uICgkc2NvcGUpIHtcblxuICAgIC8vIFNldCBzb21lIG9wdGlvbnMgZm9yIENvZGVNaXJyb3IuXG4gICAgJHNjb3BlLmVkaXRvck9wdGlvbnMgPSB7XG4gICAgICAgIGxpbmVXcmFwcGluZzogdHJ1ZSxcbiAgICAgICAgYXV0b0Nsb3NlQnJhY2tldHM6IHRydWUsXG4gICAgICAgIG1vZGU6ICdqYXZhc2NyaXB0J1xuICAgIH07XG5cbiAgICAvLyBDcmVhdGUgdGhlIHBvc3NpYmxlIGxpc3Qgb2YgYWN0aW9ucy5cbiAgICAkc2NvcGUuYWN0aW9uT3B0aW9ucyA9IFt7IHZhbHVlOiAndG9wJywgbGFiZWw6ICdTY3JvbGwgdG8gdG9wJywgZ3JvdXA6ICdTY3JvbGxpbmcnLCBidWlsdGluOiB0cnVlIH0sIHsgdmFsdWU6ICdib3R0b20nLCBsYWJlbDogJ1Njcm9sbCB0byBib3R0b20nLCBncm91cDogJ1Njcm9sbGluZycsIGJ1aWx0aW46IHRydWUgfSwgeyB2YWx1ZTogJ3Njcm9sbGRvd24nLCBsYWJlbDogJ1Njcm9sbCBkb3duJywgZ3JvdXA6ICdTY3JvbGxpbmcnLCBidWlsdGluOiB0cnVlIH0sIHsgdmFsdWU6ICdzY3JvbGxkb3dubW9yZScsIGxhYmVsOiAnU2Nyb2xsIGRvd24gbW9yZScsIGdyb3VwOiAnU2Nyb2xsaW5nJywgYnVpbHRpbjogdHJ1ZSB9LCB7IHZhbHVlOiAnc2Nyb2xsdXAnLCBsYWJlbDogJ1Njcm9sbCB1cCcsIGdyb3VwOiAnU2Nyb2xsaW5nJywgYnVpbHRpbjogdHJ1ZSB9LCB7IHZhbHVlOiAnc2Nyb2xsdXBtb3JlJywgbGFiZWw6ICdTY3JvbGwgdXAgbW9yZScsIGdyb3VwOiAnU2Nyb2xsaW5nJywgYnVpbHRpbjogdHJ1ZSB9LCB7IHZhbHVlOiAnc2Nyb2xscmlnaHQnLCBsYWJlbDogJ1Njcm9sbCByaWdodCcsIGdyb3VwOiAnU2Nyb2xsaW5nJywgYnVpbHRpbjogdHJ1ZSB9LCB7IHZhbHVlOiAnc2Nyb2xscmlnaHRtb3JlJywgbGFiZWw6ICdTY3JvbGwgcmlnaHQgbW9yZScsIGdyb3VwOiAnU2Nyb2xsaW5nJywgYnVpbHRpbjogdHJ1ZSB9LCB7IHZhbHVlOiAnc2Nyb2xsbGVmdCcsIGxhYmVsOiAnU2Nyb2xsIGxlZnQnLCBncm91cDogJ1Njcm9sbGluZycsIGJ1aWx0aW46IHRydWUgfSwgeyB2YWx1ZTogJ3Njcm9sbGxlZnRtb3JlJywgbGFiZWw6ICdTY3JvbGwgbGVmdCBtb3JlJywgZ3JvdXA6ICdTY3JvbGxpbmcnLCBidWlsdGluOiB0cnVlIH0sIHsgdmFsdWU6ICdiYWNrJywgbGFiZWw6ICdHbyBiYWNrJywgZ3JvdXA6ICdMb2NhdGlvbicsIGJ1aWx0aW46IHRydWUgfSwgeyB2YWx1ZTogJ2ZvcndhcmQnLCBsYWJlbDogJ0dvIGZvcndhcmQnLCBncm91cDogJ0xvY2F0aW9uJywgYnVpbHRpbjogdHJ1ZSB9LCB7IHZhbHVlOiAncmVsb2FkJywgbGFiZWw6ICdSZWxvYWQgcGFnZScsIGdyb3VwOiAnTG9jYXRpb24nLCBidWlsdGluOiB0cnVlIH0sIHsgdmFsdWU6ICdjb3B5dXJsJywgbGFiZWw6ICdDb3B5IFVSTCcsIGdyb3VwOiAnTG9jYXRpb24nLCBidWlsdGluOiB0cnVlIH0sIHsgdmFsdWU6ICdvcGVuYm9va21hcmsnLCBsYWJlbDogJ09wZW4gQm9va21hcmsvQm9va21hcmtsZXQgaW4gY3VycmVudCB0YWInLCBncm91cDogJ0Jvb2ttYXJrcycgfSwgeyB2YWx1ZTogJ29wZW5ib29rbWFya25ld3RhYicsIGxhYmVsOiAnT3BlbiBCb29rbWFyay9Cb29rbWFya2xldCBpbiBuZXcgdGFiJywgZ3JvdXA6ICdCb29rbWFya3MnIH0sIHsgdmFsdWU6ICdvcGVuYm9va21hcmtiYWNrZ3JvdW5kdGFiJywgbGFiZWw6ICdPcGVuIEJvb2ttYXJrL0Jvb2ttYXJrbGV0IGluIG5ldyBiYWNrZ3JvdW5kIHRhYicsIGdyb3VwOiAnQm9va21hcmtzJyB9LCB7IHZhbHVlOiAnZ290b3RhYicsIGxhYmVsOiAnSnVtcCB0byB0YWIgb3IgVVJMJywgZ3JvdXA6ICdUYWJzJyB9LCB7IHZhbHVlOiAnbmV3dGFiJywgbGFiZWw6ICdOZXcgdGFiJywgZ3JvdXA6ICdUYWJzJywgYnVpbHRpbjogdHJ1ZSB9LCB7IHZhbHVlOiAnY2xvc2V0YWInLCBsYWJlbDogJ0Nsb3NlIHRhYicsIGdyb3VwOiAnVGFicycsIGJ1aWx0aW46IHRydWUgfSwgeyB2YWx1ZTogJ29ubHl0YWInLCBsYWJlbDogJ0Nsb3NlIG90aGVyIHRhYnMnLCBncm91cDogJ1RhYnMnLCBidWlsdGluOiB0cnVlIH0sIHsgdmFsdWU6ICdjbG9zZWxlZnR0YWJzJywgbGFiZWw6ICdDbG9zZSB0YWJzIHRvIHRoZSBsZWZ0JywgZ3JvdXA6ICdUYWJzJywgYnVpbHRpbjogdHJ1ZSB9LCB7IHZhbHVlOiAnY2xvc2VyaWdodHRhYnMnLCBsYWJlbDogJ0Nsb3NlIHRhYnMgdG8gdGhlIHJpZ2h0JywgZ3JvdXA6ICdUYWJzJywgYnVpbHRpbjogdHJ1ZSB9LCB7IHZhbHVlOiAnY2xvbmV0YWInLCBsYWJlbDogJ0R1cGxpY2F0ZSB0YWInLCBncm91cDogJ1RhYnMnLCBidWlsdGluOiB0cnVlIH0sIHsgdmFsdWU6ICdyZW9wZW50YWInLCBsYWJlbDogJ1Jlb3BlbiBsYXN0IGNsb3NlZCB0YWInLCBncm91cDogJ1RhYnMnLCBidWlsdGluOiB0cnVlIH0sIHsgdmFsdWU6ICduZXh0dGFiJywgbGFiZWw6ICdOZXh0IHRhYicsIGdyb3VwOiAnVGFicycsIGJ1aWx0aW46IHRydWUgfSwgeyB2YWx1ZTogJ3ByZXZ0YWInLCBsYWJlbDogJ1ByZXZpb3VzIHRhYicsIGdyb3VwOiAnVGFicycsIGJ1aWx0aW46IHRydWUgfSwgeyB2YWx1ZTogJ2ZpcnN0dGFiJywgbGFiZWw6ICdGaXJzdCB0YWInLCBncm91cDogJ1RhYnMnLCBidWlsdGluOiB0cnVlIH0sIHsgdmFsdWU6ICdsYXN0dGFiJywgbGFiZWw6ICdMYXN0IHRhYicsIGdyb3VwOiAnVGFicycsIGJ1aWx0aW46IHRydWUgfSwgeyB2YWx1ZTogJ3RvZ2dsZXBpbicsIGxhYmVsOiAnUGluL3VucGluIHRhYicsIGdyb3VwOiAnVGFicycsIGJ1aWx0aW46IHRydWUgfSwgeyB2YWx1ZTogJ21vdmV0YWJsZWZ0JywgbGFiZWw6ICdNb3ZlIHRhYiBsZWZ0JywgZ3JvdXA6ICdUYWJzJywgYnVpbHRpbjogdHJ1ZSB9LCB7IHZhbHVlOiAnbW92ZXRhYnJpZ2h0JywgbGFiZWw6ICdNb3ZlIHRhYiByaWdodCcsIGdyb3VwOiAnVGFicycsIGJ1aWx0aW46IHRydWUgfSwgeyB2YWx1ZTogJ25ld3dpbmRvdycsIGxhYmVsOiAnTmV3IHdpbmRvdycsIGdyb3VwOiAnV2luZG93cycsIGJ1aWx0aW46IHRydWUgfSwgeyB2YWx1ZTogJ25ld3ByaXZhdGV3aW5kb3cnLCBsYWJlbDogJ05ldyBwcml2YXRlIHdpbmRvdycsIGdyb3VwOiAnV2luZG93cycsIGJ1aWx0aW46IHRydWUgfSwgeyB2YWx1ZTogJ2Nsb3Nld2luZG93JywgbGFiZWw6ICdDbG9zZSB3aW5kb3cnLCBncm91cDogJ1dpbmRvd3MnLCBidWlsdGluOiB0cnVlIH0sIHsgdmFsdWU6ICd6b29taW4nLCBsYWJlbDogJ1pvb20gSW4nLCBncm91cDogJ1pvb21pbmcnLCBidWlsdGluOiB0cnVlIH0sIHsgdmFsdWU6ICd6b29tb3V0JywgbGFiZWw6ICdab29tIE91dCcsIGdyb3VwOiAnWm9vbWluZycsIGJ1aWx0aW46IHRydWUgfSwgeyB2YWx1ZTogJ3pvb21yZXNldCcsIGxhYmVsOiAnUmVzZXQgWm9vbScsIGdyb3VwOiAnWm9vbWluZycsIGJ1aWx0aW46IHRydWUgfSwgeyB2YWx1ZTogJ2phdmFzY3JpcHQnLCBsYWJlbDogJ1J1biBKYXZhU2NyaXB0JywgZ3JvdXA6ICdPdGhlcicgfSwgeyB2YWx1ZTogJ2NsZWFyZG93bmxvYWRzJywgbGFiZWw6ICdDbGVhciBkb3dubG9hZHMnLCBncm91cDogJ090aGVyJywgYnVpbHRpbjogdHJ1ZSB9LCB7IHZhbHVlOiAnZGlzYWJsZScsIGxhYmVsOiAnRG8gbm90aGluZyAoZGlzYWJsZSBDaHJvbWUgc2hvcnRjdXQpJywgZ3JvdXA6ICdPdGhlcicsIGJ1aWx0aW46IHRydWUgfSwgeyB2YWx1ZTogJ2J1dHRvbm5leHR0YWInLCBsYWJlbDogJ0NsaWNrIGJ1dHRvbiBhbmQgc3dpdGNoIHRvIG5leHQgdGFiIChmb3IgVHJpYmFsIFdhcnMgcGxheWVycyknLCBncm91cDogJ090aGVyJyB9XTtcblxuICAgICRzY29wZS5pc0J1aWx0SW4gPSBmdW5jdGlvbiAoYWN0aW9uKSB7XG4gICAgICAgIGZvciAodmFyIGkgPSAwLCBsZW4gPSAkc2NvcGUuYWN0aW9uT3B0aW9ucy5sZW5ndGg7IGkgPCBsZW47IGkrKykge1xuICAgICAgICAgICAgaWYgKCRzY29wZS5hY3Rpb25PcHRpb25zW2ldLnZhbHVlID09PSBhY3Rpb24pIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gJHNjb3BlLmFjdGlvbk9wdGlvbnNbaV0uYnVpbHRpbiB8fCBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH07XG5cbiAgICAvLyBDcmVhdGUgYSBkZWZhdWx0IGFsZXJ0LlxuICAgICRzY29wZS5hbGVydHMgPSBbXTtcblxuICAgIC8qKlxuICAgICAqIENsb3NlL3JlbW92ZSBhbiBhbGVydCBhdCBhIGdpdmVuIGluZGV4LlxuICAgICAqXG4gICAgICogQHBhcmFtIGluZGV4XG4gICAgICovXG4gICAgJHNjb3BlLmNsb3NlQWxlcnQgPSBmdW5jdGlvbiAoaW5kZXgpIHtcbiAgICAgICAgJHNjb3BlLmFsZXJ0cy5zcGxpY2UoaW5kZXgsIDEpO1xuICAgIH07XG5cbiAgICAvKipcbiAgICAgKiBDcmVhdGUgYSBmbGF0IGxpc3Qgb2YgYm9va21hcmtzIGZyb20gYSB0cmVlLlxuICAgICAqXG4gICAgICogQHBhcmFtIGJvb2ttYXJrVHJlZU5vZGVzXG4gICAgICovXG4gICAgdmFyIHRyYXZlcnNlQm9va21hcmtzID0gZnVuY3Rpb24gdHJhdmVyc2VCb29rbWFya3MoYm9va21hcmtUcmVlTm9kZXMpIHtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBib29rbWFya1RyZWVOb2Rlcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgJHNjb3BlLmJvb2ttYXJrcy5wdXNoKGJvb2ttYXJrVHJlZU5vZGVzW2ldLnRpdGxlKTtcbiAgICAgICAgICAgIGlmIChib29rbWFya1RyZWVOb2Rlc1tpXS5jaGlsZHJlbikge1xuICAgICAgICAgICAgICAgIHRyYXZlcnNlQm9va21hcmtzKGJvb2ttYXJrVHJlZU5vZGVzW2ldLmNoaWxkcmVuKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH07XG5cbiAgICAvLyBDcmVhdGUgdGhlIGxpc3Qgb2YgYm9va21hcmtzIGZvciBzZWxlY3Rpb24gYXMgYW4gYWN0aW9uLlxuICAgICRzY29wZS5ib29rbWFya3MgPSBbXTtcbiAgICBjaHJvbWUuYm9va21hcmtzLmdldFRyZWUoZnVuY3Rpb24gKHJlc3VsdHMpIHtcbiAgICAgICAgdHJhdmVyc2VCb29rbWFya3MocmVzdWx0cyk7XG4gICAgICAgICRzY29wZS5ib29rbWFya3Muc29ydCgpO1xuICAgICAgICAkc2NvcGUuYm9va21hcmtzID0gJHNjb3BlLmJvb2ttYXJrcy5maWx0ZXIoZnVuY3Rpb24gKG4pIHtcbiAgICAgICAgICAgIHJldHVybiBuICE9PSAnJztcbiAgICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICAvKipcbiAgICAgKiBHaXZlbiBhbiBhY3Rpb24gbWFjaGluZSBuYW1lLCByZXR1cm4gdGhlIHJlYWRhYmxlIGxhYmVsIGZvciB0aGUgZ2l2ZW4gYWN0aW9uLlxuICAgICAqXG4gICAgICogQHBhcmFtIGFjdGlvblxuICAgICAqL1xuICAgIHZhciBhY3Rpb25Ub0xhYmVsID0gZnVuY3Rpb24gYWN0aW9uVG9MYWJlbChhY3Rpb24pIHtcbiAgICAgICAgaWYgKGFjdGlvbiA9PT0gJ25vbmUnKSB7XG4gICAgICAgICAgICByZXR1cm4gJ05ldyBrZXlib2FyZCBzaG9ydGN1dCc7XG4gICAgICAgIH1cbiAgICAgICAgZm9yICh2YXIgaSA9IDAsIGxlbiA9ICRzY29wZS5hY3Rpb25PcHRpb25zLmxlbmd0aDsgaSA8IGxlbjsgaSsrKSB7XG4gICAgICAgICAgICBpZiAoJHNjb3BlLmFjdGlvbk9wdGlvbnNbaV0udmFsdWUgPT09IGFjdGlvbikge1xuICAgICAgICAgICAgICAgIHJldHVybiAkc2NvcGUuYWN0aW9uT3B0aW9uc1tpXS5sYWJlbDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH07XG5cbiAgICAkc2NvcGUua2V5TGFiZWwgPSBmdW5jdGlvbiAoa2V5KSB7XG4gICAgICAgIGlmIChrZXkuY3VzdG9tTmFtZSkge1xuICAgICAgICAgICAgcmV0dXJuIGtleS5jdXN0b21OYW1lO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIGFjdGlvblRvTGFiZWwoa2V5LmFjdGlvbik7XG4gICAgICAgIH1cbiAgICB9O1xuXG4gICAgJHNjb3BlLmtleXMgPSBbXTtcblxuICAgIC8qKlxuICAgICAqIElmIHdlIGRvbid0IGhhdmUgYW55IHNob3J0Y3V0cyBjb25maWd1cmVkLCBhZGQgYW4gZW1wdHkgb25lLlxuICAgICAqL1xuICAgICRzY29wZS5hZGRCbGFua0lmRW1wdHkgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICgkc2NvcGUua2V5cy5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgICRzY29wZS5hZGRFbXB0eSgpO1xuICAgICAgICB9XG4gICAgfTtcblxuICAgIC8qKlxuICAgICAqIEFkZCBhbiBlbXB0eSBzaG9ydGN1dCBjb25maWcgc28gdGhhdCB0aGUgdXNlciBoYXMgc29tZXRoaW5nIHRvIHN0YXJ0IGZyb20uXG4gICAgICovXG4gICAgJHNjb3BlLmFkZEVtcHR5ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAkc2NvcGUua2V5cy5wdXNoKHtcbiAgICAgICAgICAgIGtleTogJycsXG4gICAgICAgICAgICBhY3Rpb246ICdub25lJyxcbiAgICAgICAgICAgIGJsYWNrbGlzdDogZmFsc2UsXG4gICAgICAgICAgICBzaXRlczogJyptYWlsLmdvb2dsZS5jb20qJyxcbiAgICAgICAgICAgIG9wZW46IHRydWVcbiAgICAgICAgfSk7XG4gICAgfTtcblxuICAgIC8qKlxuICAgICAqIERlbGV0ZSBhIHNob3J0Y3V0IGF0IGEgZ2l2ZW4gaW5kZXguIFVzZWQgYnkgdGhlIFwiRGVsZXRlXCIgYnV0dG9ucy9saW5rcy5cbiAgICAgKlxuICAgICAqIEBwYXJhbSBpbmRleFxuICAgICAqL1xuICAgICRzY29wZS5kZWxldGVLZXkgPSBmdW5jdGlvbiAoaW5kZXgpIHtcbiAgICAgICAgJHNjb3BlLmtleXMuc3BsaWNlKGluZGV4LCAxKTtcbiAgICB9O1xuXG4gICAgLyoqXG4gICAgICogU2F2ZSB0aGUgY29uZmlnIGZvcm0gdG8gQ2hyb21lIHN5bmMgYW5kIGxvY2FsU3RvcmFnZS5cbiAgICAgKi9cbiAgICAkc2NvcGUuc2F2ZUtleXMgPSBmdW5jdGlvbiAoKSB7XG5cbiAgICAgICAgLy8gUmVtb3ZlIGVtcHR5IGtleXNcbiAgICAgICAgJHNjb3BlLmtleXMgPSAkc2NvcGUua2V5cy5maWx0ZXIoZnVuY3Rpb24gKGVsZW1lbnQpIHtcbiAgICAgICAgICAgIHJldHVybiBlbGVtZW50ICYmIGVsZW1lbnQua2V5ICE9PSAnJztcbiAgICAgICAgfSk7XG5cbiAgICAgICAgLy8gQ29udmVydCB0aGUgXCJzaXRlc1wiIHRleHRhcmVhIGZvciBlYWNoIHNob3J0Y3V0IGludG8gYW4gYXJyYXkgc2VwYXJhdGVkIGJ5IG5ld2xpbmVzLlxuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8ICRzY29wZS5rZXlzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAkc2NvcGUua2V5c1tpXS5vcGVuID0gZmFsc2U7IC8vIENsb3NlIHVwIHRoZSBvcGVuIGFjY29yZGlvbnMuXG4gICAgICAgICAgICBpZiAodHlwZW9mICRzY29wZS5rZXlzW2ldLnNpdGVzID09PSAnc3RyaW5nJykge1xuICAgICAgICAgICAgICAgICRzY29wZS5rZXlzW2ldLnNpdGVzQXJyYXkgPSAkc2NvcGUua2V5c1tpXS5zaXRlcy5zcGxpdCgnXFxuJyk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICRzY29wZS5rZXlzW2ldLnNpdGVzQXJyYXkgPSAkc2NvcGUua2V5c1tpXS5zaXRlcztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIC8vIFNhdmUgdGhlIHNldHRpbmdzIHRvIENocm9tZSBzdG9yYWdlIHN5bmMgYW5kIGxvY2FsU3RvcmFnZS5cbiAgICAgICAgdmFyIHNldHRpbmdzID0geyBrZXlzOiAkc2NvcGUua2V5cyB9O1xuICAgICAgICBjaHJvbWUuc3RvcmFnZS5zeW5jLnNldChzZXR0aW5ncywgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgaWYgKGNocm9tZS5ydW50aW1lLmxhc3RFcnJvcikge1xuICAgICAgICAgICAgICAgIGNocm9tZS5zdG9yYWdlLnN5bmMuY2xlYXIoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuYWxlcnRzID0gW3sgdHlwZTogJ3N1Y2Nlc3MnLCBtc2c6IFwiWW91ciBzZXR0aW5ncyB3ZXJlIHNhdmVkLCBidXQgdGhleSB3ZXJlIHRvbyBsYXJnZSB0byBiZSBzeW5jZWQgdG8gYW55IG90aGVyIENocm9tZSBpbnN0YWxsYXRpb25zIHlvdSBoYXZlIGR1ZSB0byBDaHJvbWUncyA4S0IgbGltaXRhdGlvbiBvbiB0aGUgc3RvcmFnZSBzeW5jIEFQSS4gRXZlcnl0aGluZyB3aWxsIHN0aWxsIHdvcmssIGJ1dCBpZiB5b3UgYXJlIGxvZ2dlZCBpbnRvIENocm9tZSBvbiBhbnkgb3RoZXIgY29tcHV0ZXJzLCB0aGUgc2V0dGluZ3Mgd29uJ3Qgc3luYyB0aGVyZS5cIiB9XTtcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLiRhcHBseSgpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgbG9jYWxTdG9yYWdlLnNob3J0a2V5cyA9IEpTT04uc3RyaW5naWZ5KHNldHRpbmdzKTsgLy8gQFRPRE86IFdoeSBhcmUgd2Ugc3RyaW5naWZ5aW5nPyBTdG9wIHRoYXQuXG5cbiAgICAgICAgLy8gQWRkIGEgc3VjY2VzcyBtZXNzc2FnZSwgYW4gZW1wdHkgY29uZmlnIGlmIG5lZWRlZCwgYW5kIHNjcm9sbCB1cC5cbiAgICAgICAgJHNjb3BlLmFsZXJ0cyA9IFt7IHR5cGU6ICdzdWNjZXNzJywgbXNnOiAnWW91ciBzZXR0aW5ncyB3ZXJlIHNhdmVkISBSZWxvYWQgeW91ciB0YWJzIHRvIHVzZSB5b3VyIG5ldyBzaG9ydGN1dHMuJyB9XTtcbiAgICAgICAgJHNjb3BlLmFkZEJsYW5rSWZFbXB0eSgpO1xuICAgICAgICB3aW5kb3cuc2Nyb2xsKDAsIDApO1xuICAgIH07XG5cbiAgICAvLyBBdHRlbXB0IHRvIGZldGNoIGNvbmZpZyBmcm9tIENocm9tZSBzdG9yYWdlIHN5bmMsIGFuZCBmYWxsIGJhY2sgdG8gbG9jYWxTdG9yYWdlXG4gICAgLy8gaWYgbm90IGZvdW5kIChpLmUuLCBpZiB0aGUgdXNlciBuZXZlciBlbmFibGVkIHN5bmMgaW4gdmVyc2lvbiAxLlxuICAgIGNocm9tZS5zdG9yYWdlLnN5bmMuZ2V0KG51bGwsIGZ1bmN0aW9uIChyZXNwb25zZSkge1xuICAgICAgICBpZiAocmVzcG9uc2UgJiYgcmVzcG9uc2Uua2V5cykge1xuICAgICAgICAgICAgJHNjb3BlLmtleXMgPSByZXNwb25zZS5rZXlzO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdmFyIHNldHRpbmdzU3RyID0gbG9jYWxTdG9yYWdlLnNob3J0a2V5cztcbiAgICAgICAgICAgIGlmIChzZXR0aW5nc1N0cikge1xuICAgICAgICAgICAgICAgIHZhciBzZXR0aW5ncyA9IEpTT04ucGFyc2Uoc2V0dGluZ3NTdHIpO1xuICAgICAgICAgICAgICAgICRzY29wZS5rZXlzID0gc2V0dGluZ3Mua2V5cyB8fCBbXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICAkc2NvcGUuYWRkQmxhbmtJZkVtcHR5KCk7XG4gICAgICAgICRzY29wZS4kYXBwbHkoKTtcbiAgICB9KTtcbn1dKTsiXSwic291cmNlUm9vdCI6Ii9zb3VyY2UvIn0=
